<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุณุฌูู ุฅูุฌุงุฒ ุฏูุฑุฉ - ุงููุนูููู</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background: #f4f6f8; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 400px; text-align: center; }
        h2 { color: #1e5f74; margin-bottom: 20px; }
        label { display: block; text-align: right; margin-bottom: 5px; font-size: 14px; font-weight: bold; color: #555; }
        select, input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Tajawal'; box-sizing: border-box; outline: none; transition: 0.3s; background: #fff; }
        select:focus, input:focus { border-color: #1e5f74; box-shadow: 0 0 5px rgba(30,95,116,0.2); }
        button { width: 100%; padding: 12px; background: #1e5f74; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 5px; }
        button:hover { background: #164656; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .msg { display: none; margin-top: 15px; padding: 10px; border-radius: 5px; font-size: 13px; line-height: 1.6; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>

<div class="container">
    <h2>ุชุณุฌูู ุฅูุฌุงุฒ ุฏูุฑุฉ</h2>
    <p style="font-size:13px; color:#666;">ูุถูุงูุ ุงุฎุชุฑ ุงูุฏูุฑุฉ ุฃููุงู ูุชุธูุฑ ูู ูุงุฆูุฉ ุงูุฃุณูุงุก</p>

    <label>ุงุฎุชุฑ ุงูุจุฑูุงูุฌ ุงูุชุฏุฑูุจู:</label>
    <select id="courseSelect">
        <option value="" disabled selected>-- ุงุถุบุท ููุง ูุงุฎุชูุงุฑ ุงูุฏูุฑุฉ --</option>
        <option value="0">ุงูุชุฎุทูุท ููุชุฏุฑูุณ (ูุนูููู)</option>
        <option value="1">ุงูุชุฏุฑูุณ ุงููุนุงู (ูุนูููู)</option>
        <option value="2">ุฅุฏุงุฑุฉ ุงูุจูุฆุฉ ุงูุตููุฉ (ูุนูููู)</option>
        <option value="3">ุงูุชูููู ูู ุฃุฌู ุงูุชุนูู (ูุนูููู)</option>
        <option value="4">ุฅุฏุงุฑุฉ ุงูุฃุฏุงุก ุงููุธููู (ุฅุฏุงุฑููู)</option>
        <option value="5">ุชุนุฒูุฒ ุงูุฃุณุงููุจ (ุนุฑุจู)</option>
        <option value="6">ุชุนุฒูุฒ ุงูุฃุณุงููุจ (ุนููู)</option>
        <option value="7">ุชุนุฒูุฒ ุงูุฃุณุงููุจ (ุฑูุงุถูุงุช)</option>
        <option value="8">ุจุฑุงูุฌ ุงูุชูุฌูู ุงูุทูุงุจู (ุงูููุฌู)</option>
    </select>

    <label>ุงุณู ุงููููุฐ:</label>
    <select id="tName">
        <option value="" disabled selected>-- ุงุฎุชุฑ ุงูุฏูุฑุฉ ุฃููุงู --</option>
    </select>

    <label>ุฑุงุจุท ุงูุดุงูุฏ / ุงูุดูุงุฏุฉ:</label>
    <input type="url" id="tLink" placeholder="https://..." required>
    
    <button id="btnSubmit">๐ค ุฅุฑุณุงู ุงูุจูุงูุงุช</button>
    <div id="msgBox" class="msg"></div>
</div>

<script>
    (function() {
        // ุจูุงูุงุช ุงูุฃุณูุงุก
        var staffData = {
            teachers: [
                "ุฃุญูุฏ ุฅุจุฑุงููู ุนูู ุขู ุตููุฏ ุนุณูุฑู", "ุฃุญูุฏ ุจู ุณุนูุฏ ุจู ุนูู ุนุณูุฑู", "ุฃุญูุฏ ุนูู ุญุณู ุขู ุฐูุงุจ",
                "ุฃุญูุฏ ุนูู ูุญูุฏ ุขู ุงููุนูุฏ", "ุฃุญูุฏ ููุงุนู ุฃุญูุฏ ุนุณูุฑู", "ุฃุญูุฏ ูุญูุฏ ูุณูุฑ ุงููุฌูุจ ุนุณูุฑู",
                "ุจูุบูุซ ูุญูุฏ ุจูุบูุซ ุงูุฎุงูุฏู", "ุฌุงุจุฑ ุฃุญูุฏ ุนูู ุขู ููุงุถูุฉ ุนุณูุฑู", "ุฌูุงู ุนูู ููุฑุญ ุงูุดูุฑู",
                "ุญุณู ูุญูู ุญุณู ุงูุดูุฑู", "ุฎุงูุฏ ุนูู ุนุจุฏุงููู ุงูุดูุฑู", "ุณุงูู ุญุณู ุนูุถ ุงูุดูุฑู",
                "ุนุงุฏู ุตุงูุญ ุฌุฑูุจูุน ุงูุฒูุฑุงูู", "ุนุงูุฑ ุฃุญูุฏ ูุญูุฏ ุงูุดูุฑู", "ุนุงูุฑ ุญุณู ุฃุญูุฏ ุนุณูุฑู",
                "ุนุงูุฑ ุนุจุฏุงููู ุนูู ุงูุดูุฑู", "ุนูู ุฅุจุฑุงููู ูุญูุฏ ุนุณูุฑู", "ุนูู ุจู ุฃุญูุฏ ุจู ุนูู ุงูุดูุฑู",
                "ุนูู ุดุจููู ุญุณู ุขู ุตููุงู ุงูุดูุฑู", "ุนูู ูุญูุฏ ุนูู ุงูุดูุฎู ุนุณูุฑู", "ุนูู ูุญูุฏ ูุญูู ุญููู",
                "ุนูู ูุงุดู ูุญูุฏ ุงููุงุดูู", "ุนูุถ ุฃุญูุฏ ุงูุดูุฑู", "ุนูุณู ูุญูู ุณุนูุฏ ุนุณูุฑู",
                "ููุฏ ุจู ููุงู ุจู ูุญูุฏ ุงูุฒูุงูู ุงูุดูุฑู", "ูุญูุฏ ุญุณู ุฌุงุจุฑ ุงูุฎููู", "ูุญูุฏ ุนูู ุนุงูุฑ ุงููุญููุธู ุงูุฃุณูุฑู",
                "ูุญูุฏ ุนูู ูุญูุฏ ุขู ูุนูุชุฑ ุนุณูุฑู", "ูุญูุฏ ูุงุตุฑ ูุญูุฏ ุขู ูุญูุฏ ุงูุฃุณูุฑู", "ูุญูุฏ ููุงุฒุน ูุงูุน ุงูุดูุฑู",
                "ูุฏูุด ุนูุถ ูุฏูุด ุงููููู", "ูุญูู ูุญูุฏ ูุงูุน ุงูุดูุฑู"
            ],
            admins: [
                "ูุญูุฏ ุฃุญูุฏ ุนูู ุงูุดูุฑู", "ุญุณู ุนูู ูุญูุฏ ุงูุดูุฑู", 
                "ูุญูุฏ ุฌุงุจุฑ ุฃุญูุฏ ุนุณูุฑู", "ุญุณู ูุนุฏู ุนุณูุฑู"
            ],
            counselor: ["ุฌูุงู ุนูู ููุฑุญ ุงูุดูุฑู"],
            
            arabic: [
                "ุฃุญูุฏ ุฅุจุฑุงููู ุนูู ุขู ุตููุฏ ุนุณูุฑู", "ุณุงูู ุญุณู ุนูุถ ุงูุดูุฑู",
                "ุนูู ูุญูุฏ ุนูู ุงูุดูุฎู ุนุณูุฑู", "ุนูุถ ุฃุญูุฏ ูุญูุฏ ุงูุดูุฑู",
                "ูุญูุฏ ูุงุตุฑ ูุญูุฏ ุขู ูุญูุฏ ุงูุฃุณูุฑู"
            ],
            science: [
                "ุฃุญูุฏ ุจู ุณุนูุฏ ุจู ุนูู ุนุณูุฑู", "ุนุงุฏู ุตุงูุญ ุฌุฑูุจูุน ุงูุฒูุฑุงูู",
                "ูุญูุฏ ุญุณู ุฌุงุจุฑ ุงูุฎููู", "ูุญูุฏ ุนูู ูุญูุฏ ุขู ูุนูุชุฑ ุนุณูุฑู"
            ],
            math: [
                "ุจูุบูุซ ูุญูุฏ ุจูุบูุซ ุงูุฎุงูุฏู", "ุฎุงูุฏ ุนูู ุนุจุฏุงููู ุงูุดูุฑู",
                "ุนุงูุฑ ุฃุญูุฏ ูุญูุฏ ุงูุดูุฑู", "ููุฏ ุจู ููุงู ุจู ูุญูุฏ ุงูุฒูุงูู ุงูุดูุฑู",
                "ูุญูุฏ ุนูู ุนุงูุฑ ุงููุญููุธู ุงูุฃุณูุฑู"
            ]
        };

        var courseSelect = document.getElementById('courseSelect');
        var nameSelect = document.getElementById('tName');

        // ุฏุงูุฉ ุงูุชุญุฏูุซ
        function updateNames() {
            var val = courseSelect.value;
            if(!val && val !== "0") return; // ุฅุฐุง ูู ูุฎุชุฑ ุดูุฆุงู
            
            var idx = parseInt(val);
            var list = [];

            if (idx === 4) list = staffData.admins;
            else if (idx === 8) list = staffData.counselor;
            else if (idx === 5) list = staffData.arabic;
            else if (idx === 6) list = staffData.science;
            else if (idx === 7) list = staffData.math;
            else list = staffData.teachers;

            // ุชูุฑูุบ ุงููุงุฆูุฉ
            nameSelect.innerHTML = '<option value="" disabled selected>-- ุงุฎุชุฑ ุงุณูู --</option>';

            if(list && list.length > 0) {
                list.sort(function(a, b){ return a.localeCompare(b, 'ar'); });
                for(var i=0; i<list.length; i++) {
                    var opt = document.createElement('option');
                    opt.value = list[i];
                    opt.text = list[i];
                    nameSelect.appendChild(opt);
                }
            } else {
                var opt = document.createElement('option');
                opt.text = "(ูุง ุชูุฌุฏ ุฃุณูุงุก)";
                nameSelect.appendChild(opt);
            }
        }

        // ุฑุจุท ุงูุญุฏุซ
        courseSelect.addEventListener('change', updateNames);
    })();
</script>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCqG4A1sx02N1HNR0bqUHMh7EUGEK1vvxU",
      authDomain: "my-report-e8538.firebaseapp.com",
      databaseURL: "https://my-report-e8538-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "my-report-e8538",
      storageBucket: "my-report-e8538.firebasestorage.app",
      messagingSenderId: "1058251518699",
      appId: "1:1058251518699:web:8a3d68d4c69de53a5d84ae"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    function isValidHttpUrl(string) {
        let url;
        try { url = new URL(string); } catch (_) { return false; }
        return url.protocol === "http:" || url.protocol === "https:";
    }

    document.getElementById('btnSubmit').addEventListener('click', function() {
        const btn = document.getElementById('btnSubmit');
        const nameSelect = document.getElementById('tName');
        const courseSelect = document.getElementById('courseSelect');
        const msgBox = document.getElementById('msgBox');
        
        const name = nameSelect.value;
        const link = document.getElementById('tLink').value.trim();
        const courseIdx = courseSelect.value;

        // ุงูุชุญูู ูู ุงุฎุชูุงุฑ ุงูุฏูุฑุฉ
        if (!courseIdx && courseIdx !== "0") {
            showMsg("โ ูุถูุงู ุงุฎุชุฑ ุงูุฏูุฑุฉ ุฃููุงู.", "error");
            return;
        }

        // ุงูุชุญูู ูู ุงุฎุชูุงุฑ ุงูุงุณู
        if (!name || name === "") {
            showMsg("โ ูุถูุงู ุงุฎุชุฑ ุงุณูู ูู ุงููุงุฆูุฉ.", "error");
            return;
        }

        if (!isValidHttpUrl(link)) {
            showMsg("โ ุงูุฑุงุจุท ุบูุฑ ุตุญูุญ! ูุฌุจ ุฃู ูุจุฏุฃ ุจู https://", "error");
            return;
        }

        btn.disabled = true;
        btn.innerHTML = "โณ ุฌุงุฑู ุงูุฅุฑุณุงู...";
        msgBox.style.display = 'none';

        push(ref(db, `Ali_Training_Data/${courseIdx}`), {
            n: name,
            link: link,
            s: 2, 
            r: "ุชู ุงูุฅุฑุณุงู ุฐุงุชูุงู",
            timestamp: new Date().toISOString()
        })
        .then(() => {
            showMsg("โ ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ!", "success");
            document.getElementById('tLink').value = "";
            btn.innerHTML = "๐ค ุฅุฑุณุงู ุจูุงูุงุช ุฃุฎุฑู";
            btn.disabled = false;
        })
        .catch((error) => {
            showMsg("โ ุญุฏุซ ุฎุทุฃ: " + error.message, "error");
            btn.disabled = false;
            btn.innerHTML = "๐ค ุฅุฑุณุงู ุงูุจูุงูุงุช";
        });
    });

    function showMsg(text, type) {
        const box = document.getElementById('msgBox');
        box.innerHTML = text;
        box.className = "msg " + type;
        box.style.display = "block";
    }
</script>

</body>
</html>